<UserControl x:Class="MetaMorpheusGUI.DeconExplorationTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MetaMorpheusGUI"
             xmlns:guiFunctions="clr-namespace:GuiFunctions;assembly=GuiFunctions"
             mc:Ignorable="d" 
             d:DataContext="{d:DesignInstance guiFunctions:DeconExplorationViewModel, IsDesignTimeCreatable=True}"  
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="6"/>
            <ColumnDefinition Width="5*"/>
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Left: File and scan selection -->
        <StackPanel Grid.Column="0" Grid.Row="0"  Margin="8">
            <TextBlock Text="Select Data File:" FontWeight="Bold"/>
            <ComboBox ItemsSource="{Binding MsDataFiles}" 
                   SelectedItem="{Binding SelectedMsDataFile}" 
                   DisplayMemberPath="FilePath" Margin="0,4,0,12"/>
            <TextBlock Text="Scans:" FontWeight="Bold"/>
            <DataGrid ItemsSource="{Binding Scans}" 
                   SelectedItem="{Binding SelectedMsDataScan}" 
                   AutoGenerateColumns="False" Height="200" Margin="0,4,0,12">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Scan #" Binding="{Binding OneBasedScanNumber}" Width="60"/>
                    <DataGridTextColumn Header="RT" Binding="{Binding RetentionTime}" Width="60"/>
                    <DataGridTextColumn Header="MS Order" Binding="{Binding MsnOrder}" Width="60"/>
                    <DataGridTextColumn Header="Isolation" Binding="{Binding IsolationMz}" Width="60"/>
                </DataGrid.Columns>
            </DataGrid>
            <TextBlock Text="Deconvolution Mode:" FontWeight="Bold"/>
            <ComboBox SelectedValue="{Binding Mode}" ItemsSource="{Binding DeconvolutionModes}"  Margin="0,4,0,12" />

            <Button Content="Run Deconvolution" Command="{Binding RunDeconvolutionCommand}" Margin="0,8,0,0"/>
        </StackPanel>
        
        <!-- Grid Splitter -->
        <GridSplitter Grid.Column="1" Grid.Row="0" Width="6" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

        <!-- Right: Deconvoluted species -->
        <DataGrid Grid.Column="2" Grid.Row="0"  ItemsSource="{Binding DeconvolutedSpecies}" AutoGenerateColumns="False" Margin="8">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Mono Mass" Binding="{Binding MonoisotopicMass}" Width="100"/>
                <DataGridTextColumn Header="Mz" Binding="{Binding MostAbundantMz}" Width="100"/>
                <DataGridTextColumn Header="Charge" Binding="{Binding Charge}" Width="60"/>
                <DataGridTextColumn Header="Intensity" Binding="{Binding Intensity}" Width="80"/>
                <DataGridTextColumn Header="Peak Count" Binding="{Binding PeakCount}" Width="80"/>
            </DataGrid.Columns>
        </DataGrid>

        <Expander Grid.Column="2" Grid.Row="1" Header="Deconvolution Parameters">
            <local:HostDeconParamControl Margin="8" 
                                         DataContext="{Binding DeconHostViewModel}" />
        </Expander>
    </Grid>
</UserControl>
