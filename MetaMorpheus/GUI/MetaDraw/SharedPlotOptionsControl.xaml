<UserControl x:Class="MetaMorpheusGUI.SharedPlotOptionsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MetaMorpheusGUI"
             xmlns:parallelSearch="clr-namespace:GuiFunctions.ViewModels.ParallelSearchTask;assembly=GuiFunctions"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="300">
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="4">

			<Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

			<Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Select Test -->
			<StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal">
				<Label Content="Select Test:" FontWeight="SemiBold" Margin="0 0 0 2" />
				<ComboBox ItemsSource="{Binding AvailableTests}"
						  SelectedItem="{Binding SelectedTest}"
						  Height="24" Width="256"
						  ToolTip="Select a specific statistical test to display">
					<ComboBox.ItemTemplate>
						<DataTemplate>
							<TextBlock Text="{Binding}" />
						</DataTemplate>
					</ComboBox.ItemTemplate>
				</ComboBox>
            </StackPanel>

            <!-- Taxonomic Grouping (Manhattan Plot Only) -->
			<StackPanel Grid.Row="1" Grid.Column="0"  Orientation="Horizontal">
				<Label Content="Taxonomic Group:" FontWeight="SemiBold" Margin="0 0 0 2"
					   Visibility="{Binding IsManhattanPlotSelected, Converter={local:BooleanToVisibilityConverter}}" />
				<ComboBox SelectedItem="{Binding ManhattanPlot.GroupBy}"
						  Height="24" Width="64"
						  Margin="0 0 0 10"
						  Visibility="{Binding IsManhattanPlotSelected, Converter={local:BooleanToVisibilityConverter}}"
						  ToolTip="Select taxonomic level for color grouping">
					<ComboBox.Items>
						<parallelSearch:TaxonomicGrouping>Organism</parallelSearch:TaxonomicGrouping>
						<parallelSearch:TaxonomicGrouping>Kingdom</parallelSearch:TaxonomicGrouping>
						<parallelSearch:TaxonomicGrouping>Phylum</parallelSearch:TaxonomicGrouping>
						<parallelSearch:TaxonomicGrouping>Class</parallelSearch:TaxonomicGrouping>
						<parallelSearch:TaxonomicGrouping>Order</parallelSearch:TaxonomicGrouping>
						<parallelSearch:TaxonomicGrouping>Family</parallelSearch:TaxonomicGrouping>
						<parallelSearch:TaxonomicGrouping>Genus</parallelSearch:TaxonomicGrouping>
						<parallelSearch:TaxonomicGrouping>Species</parallelSearch:TaxonomicGrouping>
						<parallelSearch:TaxonomicGrouping>None</parallelSearch:TaxonomicGrouping>
					</ComboBox.Items>
				</ComboBox>
			</StackPanel>


            <!-- Top N Groups -->
			<StackPanel Grid.Row="2" Grid.Column="0" >
                <Label Content="Top N Groups for Legend:" FontWeight="SemiBold" Margin="0 0 0 2" />
                <StackPanel Orientation="Horizontal" Margin="0 0 0 10">
                    <local:IntegerTexBoxControl Text="{Binding TopNGroups, UpdateSourceTrigger=PropertyChanged}"
                                                Width="80" VerticalContentAlignment="Center" Height="24" AllowNegative="False" />
                    <TextBlock Text="(0 = show all)"
                                VerticalAlignment="Center"
                                Foreground="Gray"
                                FontSize="10"
                                Margin="5 0 0 0" />
                </StackPanel>
            </StackPanel>
			
            <!-- Max Points to Plot -->
			<StackPanel Grid.Row="2" Grid.Column="1">
                <Label Content="Max Data Points:" FontWeight="SemiBold" Margin="0 0 0 2" />
                <StackPanel Orientation="Horizontal" Margin="0 0 0 10">
                    <local:IntegerTexBoxControl Text="{Binding MaxPointsToPlot, UpdateSourceTrigger=PropertyChanged}"
                                                AllowNegative="False"
                                                Width="80" VerticalContentAlignment="Center" Height="24" />
                    <TextBlock Text="(0 = show all)"
                                VerticalAlignment="Center"
                                Foreground="Gray"
                                FontSize="10"
                                Margin="5 0 0 0" />
                </StackPanel>
            </StackPanel>

            <!-- Alpha Threshold -->
            <StackPanel Grid.Row="3" Grid.Column="0">
                <Label Content="Significance Threshold (Î±):" FontWeight="SemiBold" Margin="0 0 0 2" />
                <StackPanel Orientation="Horizontal" Margin="0 0 0 10">
                    <local:DoubleTextBoxControl Text="{Binding Alpha, StringFormat=F3, UpdateSourceTrigger=PropertyChanged}"
                                                Width="80" VerticalContentAlignment="Center" Height="24" />
                    <TextBlock Text="(default: 0.05)"
                               VerticalAlignment="Center"
                               Foreground="Gray"
                               FontSize="10"
                               Margin="5 0 0 0" />
                </StackPanel>
            </StackPanel>

            <!-- Checkboxes -->
            <StackPanel Grid.Row="3" Grid.Column="1">
                <CheckBox Content="Use Q-value (FDR-corrected)"
                          IsChecked="{Binding FilterByQValue}"
                          Margin="0 5" />

                <CheckBox Content="Show Legend"
                          IsChecked="{Binding ShowLegend}"
                          Margin="0 5" />
            </StackPanel>
        </Grid>
    </ScrollViewer>
</UserControl>
