<UserControl x:Class="MetaMorpheusGUI.PhylogeneticTreeControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MetaMorpheusGUI"
             xmlns:oxy="http://oxyplot.org/wpf"
             xmlns:parallelSearch="clr-namespace:GuiFunctions.ViewModels.ParallelSearchTask;assembly=GuiFunctions"
             xmlns:plots="clr-namespace:GuiFunctions.ViewModels.ParallelSearchTask.Plots;assembly=GuiFunctions"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800"
             d:DataContext="{d:DesignInstance plots:PhylogeneticTreeViewModel, IsDesignTimeCreatable=True}">
    <!-- Phylogenetic Tree Plot with Export Buttons and Tree-Specific Options -->
    <Border BorderBrush="LightGray" BorderThickness="1" Margin="5">
        <Grid>
            <oxy:PlotView x:Name="PhylogeneticTreePlotView" 
                          Model="{Binding PlotModel}"
                          FontSize="14" 
                          FontStretch="Expanded" 
                          VerticalAlignment="Stretch"
                          HorizontalAlignment="Stretch"
                          Margin="2" />

            <!-- Plot-Specific Options Expander - Upper Right -->
            <Expander HorizontalAlignment="Right" 
                     VerticalAlignment="Top"
                     IsExpanded="False" 
                     ExpandDirection="Down" 
                     Margin="10"
                     Background="White"
                     BorderBrush="LightGray"
                     BorderThickness="1">
                <Expander.Header>
                    <TextBlock Text="Tree Options" FontWeight="Bold" FontSize="12" Margin="5 2" />
                </Expander.Header>
                <ScrollViewer MaxHeight="500" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10" MinWidth="250">
                        <!-- Node Size Metric -->
                        <Label Content="Node Size Metric:" FontWeight="SemiBold" Margin="0 0 0 2" />
                        <ComboBox SelectedItem="{Binding NodeSizeMetric}"
                                  Height="24"
                                  Margin="0 0 0 10"
                                  ToolTip="Select metric for node sizing">
                            <ComboBox.Items>
                                <plots:NodeSizeMetric>SignificantHitCount</plots:NodeSizeMetric>
                                <plots:NodeSizeMetric>TotalHitCount</plots:NodeSizeMetric>
                                <plots:NodeSizeMetric>SignificanceRatio</plots:NodeSizeMetric>
                                <plots:NodeSizeMetric>MeanSignificance</plots:NodeSizeMetric>
                            </ComboBox.Items>
                        </ComboBox>

                        <!-- Tree Layout -->
                        <Label Content="Tree Layout:" FontWeight="SemiBold" Margin="0 0 0 2" />
                        <ComboBox SelectedItem="{Binding TreeLayout}"
                                  Height="24"
                                  Margin="0 0 0 10"
                                  ToolTip="Select tree layout style">
                            <ComboBox.Items>
                                <plots:TreeLayout>Radial</plots:TreeLayout>
                                <plots:TreeLayout>Hierarchical</plots:TreeLayout>
                            </ComboBox.Items>
                        </ComboBox>

                        <!-- Taxonomic Range Selection -->
                        <GroupBox Header="Taxonomic Range:" Margin="0 0 0 10">
                            <StackPanel>
                                <Label Content="Start Level:" FontWeight="SemiBold" Margin="0 0 0 2" />
                                <ComboBox SelectedItem="{Binding StartLevel}"
                                          Height="24"
                                          Margin="0 0 0 5"
                                          ToolTip="Select starting taxonomic level">
                                    <ComboBox.Items>
                                        <parallelSearch:TaxonomicGrouping>Kingdom</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Phylum</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Class</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Order</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Family</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Genus</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Species</parallelSearch:TaxonomicGrouping>
                                    </ComboBox.Items>
                                </ComboBox>

                                <Label Content="End Level:" FontWeight="SemiBold" Margin="0 5 0 2" />
                                <ComboBox SelectedItem="{Binding EndLevel}"
                                          Height="24"
                                          Margin="0 0 0 5"
                                          ToolTip="Select ending taxonomic level">
                                    <ComboBox.Items>
                                        <parallelSearch:TaxonomicGrouping>Kingdom</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Phylum</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Class</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Order</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Family</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Genus</parallelSearch:TaxonomicGrouping>
                                        <parallelSearch:TaxonomicGrouping>Species</parallelSearch:TaxonomicGrouping>
                                    </ComboBox.Items>
                                </ComboBox>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </Expander>
        </Grid>
    </Border>
</UserControl>
